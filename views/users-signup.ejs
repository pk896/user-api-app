<!-- views/users-signup.ejs -->
<section class="auth-page mini">
  <!-- stamp: users-signup -->
  <small class="stamp">view: users-signup</small>
  <h1 class="page-title">üßë‚Äçüíª Create an account</h1>
  <p class="page-subtitle">
    Use your real email (Gmail/Outlook) so we can verify your account and send important updates.
  </p>

  <% (success || []).forEach(msg => { %>
    <div class="flash flash-success">‚úÖ <%= msg %></div>
  <% }) %>

  <% (error || []).forEach(msg => { %>
    <div class="flash flash-error">‚ùå <%= msg %></div>
  <% }) %>

  <form action="/users/signup" method="post" class="auth-form card" autocomplete="off" novalidate>
    <label>Contact email (Gmail / Outlook)
      <input
        type="email"
        name="email"
        required
        autocomplete="email"
        placeholder="you@gmail.com"
        inputmode="email" />
      <small class="muted tiny">
        We‚Äôll send a verification link to this address.
      </small>
    </label>

    <label>Username
      <input
        type="text"
        name="username"
        minlength="3"
        maxlength="30"
        required
        placeholder="e.g. phakisi_01" />
      <small class="muted tiny">
        This is your login name. Do not use your email password here.
      </small>
    </label>

    <label>Full name
      <input
        type="text"
        name="name"
        minlength="2"
        maxlength="80"
        required
        placeholder="e.g. Jane Doe" />
    </label>

    <label>Age <span class="muted">(must be 16+)</span>
      <input
        type="number"
        name="age"
        min="16"
        max="120"
        step="1"
        required
        placeholder="16" />
    </label>

    <label>Password
      <input
        type="password"
        name="password"
        required
        minlength="6"
        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
        autocomplete="new-password" />
      <small class="muted tiny">
        This is your <strong>user password</strong>, not your Gmail password.
      </small>
    </label>

    <label>Confirm password
      <input
        type="password"
        name="confirm"
        required
        minlength="6"
        placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
        autocomplete="new-password" />
    </label>

    <label class="checkbox">
      <input type="checkbox" name="confirm16" value="1" required />
      <span>I confirm I am at least 16 years old.</span>
    </label>

    <button type="submit" class="btn xs primary wfull">Create account</button>
  </form>

  <div class="divider">or</div>

  <div class="social">
    <a href="/auth/google" class="btn xs wfull google" data-nav="true" rel="noopener">
      üîë Continue with Google
    </a>
    <p class="muted tiny" style="text-align:center;margin-top:.25rem;">
      If you sign up with Google, we‚Äôll use your Google email.
    </p>
  </div>

  <p class="auth-switch">
    Already have an account?
    <a href="/users/login" data-nav="true" rel="noopener">Log in</a>
  </p>
</section>

<style nonce="<%= typeof nonce !== 'undefined' ? nonce : '' %>">
  .auth-page.mini {
    max-width: 400px;
    margin: .9rem auto 1.2rem;
    padding: 0 .6rem;
  }
  .page-title {
    text-align: center;
    font-size: 1.05rem;
    font-weight: 800;
    margin: .2rem 0 .25rem;
  }
  .page-subtitle {
    text-align: center;
    font-size: .78rem;
    color: #6b7280;
    margin: 0 0 .7rem;
  }
  .dark-theme .page-subtitle { color: #9ca3af; }

  .card {
    background: var(--card-bg, #fff);
    border: 1px solid var(--card-bd, #e5e7eb);
    border-radius: 10px;
    padding: .7rem .7rem;
    box-shadow: 0 1px 2px rgba(0,0,0,.06);
  }
  .dark-theme .card { --card-bg:#1f2937; --card-bd:#374151; color:#e5e7eb; }

  .auth-form { display: grid; gap: .7rem; }
  label { display: grid; gap: .35rem; font-weight: 700; font-size: .85rem; }
  .checkbox { display: inline-flex; align-items: center; gap: .4rem; font-weight: 600; font-size: .82rem; }
  .muted { color: #6b7280; }
  .tiny { font-size: .78rem; }
  .dark-theme .muted { color: #9ca3af; }

  input {
    border: 1px solid #d1d5db; border-radius: 10px;
    padding: .55rem .65rem; background: #fff; font-size: .9rem;
  }
  .dark-theme input { background: #0b1220; border-color: #334155; color: #e5e7eb; }

  .btn {
    display: inline-block; text-align: center; text-decoration: none;
    border: 1px solid #d1d5db; background: #f3f4f6; color: #111827;
    border-radius: 8px; padding: .42rem .6rem; font-size: .78rem; font-weight: 700;
  }
  .btn.xs { padding: .36rem .5rem; font-size: .72rem; border-radius: 7px; }
  .btn.wfull { width: 100%; }
  .btn.primary { background: #2563eb; border-color: #2563eb; color: #fff; }
  .btn.google { background: #fff; color: #111827; border-color: #d1d5db; }
  .btn:hover { opacity: .95; }
  .dark-theme .btn { background: #374151; border-color: #4b5563; color: #e5e7eb; }
  .dark-theme .btn.primary { background: #1d4ed8; border-color: #1d4ed8; }
  .dark-theme .btn.google { background: #111827; }

  .divider { margin: .55rem auto; text-align: center; font-size: .85rem; color: #6b7280; }
  .dark-theme .divider { color: #9ca3af; }

  .social { display: grid; gap: .4rem; }
  .auth-switch { margin-top: .7rem; text-align: center; font-size: .85rem; }

  .flash { margin:.4rem 0; padding:.55rem .7rem; border-radius:.6rem; font-size:.85rem; }
  .flash-success { background:#ecfdf5; color:#065f46; border:1px solid #a7f3d0; }
  .flash-error { background:#fef2f2; color:#991b1b; border:1px solid #fecaca; }

  .stamp{display:block;margin:.2rem 0 .3rem;font-size:.72rem;opacity:.6}

  @media (max-width: 360px) {
    .auth-page.mini { padding: 0 .5rem; }
    .page-title { font-size: 1rem; }
    .page-subtitle { font-size: .75rem; }
    input { font-size: .85rem; padding: .5rem .6rem; }
    .btn.xs { font-size: .68rem; padding: .32rem .45rem; }
  }
</style>

<script nonce="<%= typeof nonce !== 'undefined' ? nonce : '' %>">
  (function () {
    const links = document.querySelectorAll('a[data-nav]');
    links.forEach(a => {
      a.addEventListener('click', function (e) {
        e.preventDefault();
        e.stopPropagation();
        window.location.assign(a.getAttribute('href'));
      }, false);
      a.addEventListener('keydown', function (e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          e.stopPropagation();
          window.location.assign(a.getAttribute('href'));
        }
      }, false);
    });
  })();
</script>
