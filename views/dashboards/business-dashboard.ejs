<!-- views/business-dashboard.ejs -->
<h1 class="page-title">ğŸ’¼ Business Dashboard</h1>

<!-- âœ… Flash Messages -->
<% if (success && success.length > 0) { %>
  <div class="flash flash-success"><%= success %></div>
<% } %>
<% if (error && error.length > 0) { %>
  <div class="flash flash-error"><%= error %></div>
<% } %>

<div class="welcome-block">
  <h2>Welcome, <%= business ? business.name : "Business User" %> ğŸ‘‹</h2>

  <!-- Use POST for logout (your router defines POST /business/logout) -->
  <form action="/business/logout" method="post" style="margin:0;">
    <button type="submit" class="btn small logout-btn">ğŸšª Logout</button>
  </form>
</div>

<!-- ğŸ“Š Dashboard Stats -->
<div class="stats-grid">
  <div class="stat-card products">
    <h3>ğŸ›ï¸ Total Products</h3>
    <p><%= (stats && stats.totalProducts) || 0 %></p>
  </div>

  <div class="stat-card sales">
    <h3>ğŸ’° Total Sales</h3>
    <p><%= (stats && stats.totalSales) || 0 %></p>
  </div>

  <!-- Mail-only: turn â€œMessagesâ€ into a Support card -->
  <div class="stat-card support">
    <h3>ğŸ›Ÿ Support</h3>
    <p>Need help? <a href="/contact" class="support-link">Contact us</a></p>
  </div>
</div>

<!-- âœ¨ Helpful shortcuts -->
<div class="quick-links">
  <a href="/products/add" class="q-link">â• Add Product</a>
  <a href="/sales" class="q-link">ğŸ›’ View Shop</a>
  <a href="/business/profile" class="q-link">ğŸ‘¤ Profile</a>
  <a href="/contact" class="q-link">ğŸ“¨ Contact Support</a>
</div>

<style nonce="<%= nonce %>">
  .page-title { text-align:center; margin:1rem 0; font-size:1.7rem; font-weight:700; }
  .welcome-block { display:flex; justify-content:space-between; align-items:center; max-width:800px; margin:0 auto 1rem; }

  .stats-grid {
    display:grid; grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
    gap:1rem; max-width:800px; margin:1rem auto;
  }
  .stat-card { border-radius:12px; padding:1rem; color:#fff; text-align:center; box-shadow:0 2px 10px rgba(0,0,0,0.1); transition:transform 0.2s ease; }
  .stat-card:hover { transform:translateY(-3px); }
  .stat-card.products { background:#2563eb; }
  .stat-card.sales { background:#16a34a; }
  .stat-card.support { background:#f59e0b; }
  .stat-card a.support-link { color:#112; background:#fff; padding:0.25rem 0.5rem; border-radius:999px; font-weight:700; text-decoration:none; display:inline-block; margin-top:0.25rem; }
  .stat-card.support a.support-link:hover { opacity:0.9; }

  .quick-links { max-width:800px; margin:0.5rem auto 2rem; display:flex; gap:0.6rem; flex-wrap:wrap; justify-content:center; }
  .q-link { background:#f3f4f6; color:#111; padding:0.55rem 0.9rem; border-radius:999px; text-decoration:none; font-weight:600; border:1px solid #e5e7eb; }
  .q-link:hover { background:#e5e7eb; }

  .flash { max-width:800px; margin:0.5rem auto; padding:0.8rem 1rem; border-radius:6px; text-align:center; font-weight:500; }
  .flash-success { background:#dcfce7; color:#166534; }
  .flash-error { background:#fee2e2; color:#991b1b; }

  /* Dark theme tweaks (optional if you use themeCss) */
  .dark-theme .q-link { background:#1f2937; color:#f9fafb; border-color:#374151; }
  .dark-theme .q-link:hover { background:#111827; }
</style>

<script nonce="<%= nonce %>">
  // (Optional) auto-dismiss flashes
  document.addEventListener("DOMContentLoaded", () => {
    setTimeout(() => {
      document.querySelectorAll(".flash").forEach(el => el.remove());
    }, 6000);
  });
</script>
